<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Racing Game</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
      }
      canvas {
        border: 1px solid black;
        display: block;
        margin: 0 auto;
        width: calc(80vh); /* Выберите нужную ширину */
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <canvas id="gameCanvas"></canvas>
    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");

      // Определение ширины и высоты canvas
      canvas.width = canvas.clientWidth;
      canvas.height = canvas.clientHeight;

      // Инициализация координат героя
      let heroX = canvas.width / 2;
      let heroY = canvas.height - 50;
      const heroWidth = 50;
      const heroHeight = 50;
      const heroSpeed = 5;

      // Массив для хранения прямоугольников
      const rectangles = [];

      // Функция создания случайного числа в заданном диапазоне
      function getRandomNumber(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      // Функция отрисовки прямоугольников
      function drawRectangles() {
        for (let i = 0; i < rectangles.length; i++) {
          const rect = rectangles[i];
          ctx.fillStyle = rect.color;
          ctx.fillRect(rect.x, rect.y, rect.width, rect.height);
        }
      }

      // Функция обновления прямоугольников (их положения)
      function updateRectangles() {
        for (let i = 0; i < rectangles.length; i++) {
          rectangles[i].y += heroSpeed / 2; // Движение прямоугольников с разной скоростью
          if (rectangles[i].y > canvas.height) {
            // Если прямоугольник вышел за пределы canvas, удаляем его
            rectangles.splice(i, 1);
          }
        }
      }

      // Функция добавления нового прямоугольника
      function addRectangle() {
        const x = getRandomNumber(0, canvas.width - heroWidth);
        const width = getRandomNumber(heroWidth, heroWidth * 3);
        const color = "#" + Math.floor(Math.random() * 16777215).toString(16); // Генерация случайного цвета
        rectangles.push({ x: x, y: 0, width: width, height: 20, color: color });
      }

      // Функция обновления игрового экрана
      function update() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawHero();
        drawRectangles();
        updateRectangles();
      }

      // Функция отрисовки героя
      function drawHero() {
        ctx.fillStyle = "orange";
        ctx.fillRect(heroX, heroY, heroWidth, heroHeight);
      }

      // Обработчик нажатия клавиш
      window.addEventListener("keydown", function (e) {
        switch (e.key) {
          case "ArrowLeft":
            if (heroX - heroSpeed >= 0) {
              heroX -= heroSpeed;
            }
            break;
          case "ArrowRight":
            if (heroX + heroWidth + heroSpeed <= canvas.width) {
              heroX += heroSpeed;
            }
            break;
          case "ArrowUp":
            if (heroY - heroSpeed >= 0) {
              heroY -= heroSpeed;
            }
            break;
          case "ArrowDown":
            if (heroY + heroHeight + heroSpeed <= canvas.height) {
              heroY += heroSpeed;
            }
            break;
          case " ":
            // Действие при нажатии пробела (ускорение или замедление)
            // В этом примере можно добавить логику для ускорения/замедления
            break;
        }
        update();
      });

      // Инициализация игры
      function init() {
        setInterval(addRectangle, 1000); // Добавление новых прямоугольников каждую секунду
        setInterval(update, 20); // Обновление экрана каждые 20 миллисекунд
      }

      // Запуск игры
      init();
    </script>
  </body>
</html>
